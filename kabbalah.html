<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kabbalistiska Livets Träd och Dödens Träd</title>
    <style>
        body { margin: 0; padding: 0; overflow: hidden; }
        #canvas { width: 100vw; height: 100vh; }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        const sephiroth = [
            ["Keter", "#FFFFFF", "Metatron"],
            ["Chokmah", "#808080", "Raziel"],
            ["Binah", "#000000", "Tzaphkiel"],
            ["Chesed", "#0000FF", "Tzadkiel"],
            ["Geburah", "#FF0000", "Khamael"],
            ["Tiferet", "#FFFF00", "Raphael"],
            ["Netzach", "#00FF00", "Haniel"],
            ["Hod", "#FFA500", "Michael"],
            ["Yesod", "#800080", "Gabriel"],
            ["Malkuth", "#8B4513", "Sandalphon"]
        ];

        const qliphoth = [
            ["Thaumiel", "#000000", "Satan & Moloch"],
            ["Ghagiel", "#8B0000", "Beelzebub"],
            ["Satariel", "#4B0082", "Lucifuge"],
            ["Gha'agsheblah", "#006400", "Astaroth"],
            ["Golachab", "#8B4513", "Asmodeus"],
            ["Tagiriron", "#708090", "Belphegor"],
            ["Harab Serapel", "#800080", "Baal"],
            ["Samael", "#B22222", "Adramelech"],
            ["Gamaliel", "#2F4F4F", "Lilith"],
            ["Nehemoth", "#A9A9A9", "Nahema"]
        ];

        const connections = [
            [0, 1], [0, 2], [1, 2], [1, 3], [1, 5], [2, 4], [2, 5],
            [3, 4], [3, 5], [3, 6], [4, 5], [4, 7], [5, 6], [5, 7],
            [5, 8], [6, 7], [6, 8], [7, 8], [8, 9], [6, 9], [7, 9],
            [0, 5]
        ];

        let lifeCenters = [];
        let deathCenters = [];
        let lastHighlightedIndex = -1;

        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            drawTrees();
        }

        function drawTree(startX, startY, scaleX, scaleY, nodes, inverted = false, mirrored = false) {
            const positions = [
                [50, inverted ? 95 : 5],
                [25, inverted ? 80 : 20],
                [75, inverted ? 80 : 20],
                [25, inverted ? 60 : 40],
                [75, inverted ? 60 : 40],
                [50, 50],
                [25, inverted ? 40 : 60],
                [75, inverted ? 40 : 60],
                [50, inverted ? 20 : 80],
                [50, inverted ? 5 : 95]
            ];

            ctx.strokeStyle = 'black';
            ctx.lineWidth = 1;
            for (let [start, end] of connections) {
                let [x1, y1] = positions[start];
                let [x2, y2] = positions[end];
                if (mirrored) {
                    x1 = 100 - x1;
                    x2 = 100 - x2;
                }
                ctx.beginPath();
                ctx.moveTo(startX + x1 * scaleX, startY + y1 * scaleY);
                ctx.lineTo(startX + x2 * scaleX, startY + y2 * scaleY);
                ctx.stroke();
            }

            const nodeCenters = [];
            for (let i = 0; i < nodes.length; i++) {
                const [name, color, _] = nodes[i];
                let [x, y] = positions[i];
                if (mirrored) {
                    x = 100 - x;
                }
                const radius = Math.min(canvas.width, canvas.height) / 50;
                const centerX = startX + x * scaleX;
                const centerY = startY + y * scaleY;

                // Rita svart kontur
                ctx.beginPath();
                ctx.arc(centerX, centerY, radius + 2, 0, 2 * Math.PI);
                ctx.fillStyle = 'black';
                ctx.fill();

                // Rita noden
                ctx.beginPath();
                ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);
                ctx.fillStyle = color;
                ctx.fill();

                ctx.font = `bold ${radius / 1.5}px Arial`;
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';

                ctx.strokeStyle = 'black';
                ctx.lineWidth = 3;
                ctx.strokeText(name, centerX, centerY);

                ctx.fillStyle = 'white';
                ctx.fillText(name, centerX, centerY);

                nodeCenters.push([centerX, centerY]);
            }

            return nodeCenters;
        }

        function drawTrees() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            const treeWidth = canvas.width / 2;
            const treeHeight = canvas.height;
            const titleHeight = 40; // Höjd för titeln
            const scaleX = treeWidth / 100;
            const scaleY = (treeHeight - titleHeight) / 100; // Justerad skala för Y-axeln

            // Rita titlar
            ctx.font = 'bold 24px Arial';
            ctx.fillStyle = 'black';
            ctx.textAlign = 'center';
            ctx.fillText("Livets Träd (Etz Chaim)", treeWidth / 2, titleHeight / 2);
            ctx.fillText("Dödens Träd (Sitra Achra)", treeWidth * 1.5, titleHeight / 2);

            lifeCenters = drawTree(0, titleHeight, scaleX, scaleY, sephiroth);
            deathCenters = drawTree(treeWidth, titleHeight, scaleX, scaleY, qliphoth, true, true);
        }

        function clearHighlight() {
            drawTrees();
            lastHighlightedIndex = -1;
        }

        function drawRoundedRect(x, y, width, height, radius) {
            ctx.beginPath();
            ctx.moveTo(x + radius, y);
            ctx.lineTo(x + width - radius, y);
            ctx.quadraticCurveTo(x + width, y, x + width, y + radius);
            ctx.lineTo(x + width, y + height - radius);
            ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);
            ctx.lineTo(x + radius, y + height);
            ctx.quadraticCurveTo(x, y + height, x, y + height - radius);
            ctx.lineTo(x, y + radius);
            ctx.quadraticCurveTo(x, y, x + radius, y);
            ctx.closePath();
        }

        function onHover(event) {
            const rect = canvas.getBoundingClientRect();
            const x = event.clientX - rect.left;
            const y = event.clientY - rect.top;

            clearHighlight();

            const radius = Math.min(canvas.width, canvas.height) / 50;
            for (let i = 0; i < lifeCenters.length; i++) {
                const [x1, y1] = lifeCenters[i];
                const [x2, y2] = deathCenters[i];

                if ((Math.abs(x - x1) <= radius && Math.abs(y - y1) <= radius) ||
                    (Math.abs(x - x2) <= radius && Math.abs(y - y2) <= radius)) {
                    
                    ctx.beginPath();
                    ctx.moveTo(x1, y1);
                    ctx.lineTo(x2, y2);
                    ctx.strokeStyle = 'red';
                    ctx.lineWidth = 2;
                    ctx.stroke();

                    const angel = sephiroth[i][2];
                    const demon = qliphoth[i][2];
                    const text = `Ängel: ${angel}\nDemon: ${demon}`;

                    const textX = canvas.width / 2;
                    const textY = canvas.height / 2;

                    ctx.font = '16px Arial';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';

                    const textWidth = Math.max(ctx.measureText(`Ängel: ${angel}`).width, ctx.measureText(`Demon: ${demon}`).width);
                    const lineHeight = 20;
                    const padding = 10;
                    const boxWidth = textWidth + padding * 2;
                    const boxHeight = lineHeight * 2 + padding * 2;

                    // Rita rundad rektangel med vit bakgrund och svart kontur
                    ctx.fillStyle = 'white';
                    drawRoundedRect(textX - boxWidth / 2, textY - boxHeight / 2, boxWidth, boxHeight, 10);
                    ctx.fill();
                    ctx.strokeStyle = 'black';
                    ctx.lineWidth = 2;
                    ctx.stroke();

                    // Rita text
                    ctx.fillStyle = 'black';
                    const lines = text.split('\n');
                    lines.forEach((line, index) => {
                        ctx.fillText(line, textX, textY + (index - 0.5) * lineHeight);
                    });

                    lastHighlightedIndex = i;
                    break;
                }
            }
        }

        window.addEventListener('resize', resizeCanvas);
        canvas.addEventListener('mousemove', onHover);

        resizeCanvas();
    </script>
</body>
</html>