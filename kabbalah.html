<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kabbalistiska Livets Träd och Dödens Träd</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --light-bg: #f0f4f8;
            --light-text: #2d3748;
            --light-accent: #4a5568;
            --dark-bg: #2d3748;
            --dark-text: #e2e8f0;
            --dark-accent: #a0aec0;
            --primary: #6b46c1;
            --secondary: #d53f8c;
        }

        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            font-family: 'Roboto', sans-serif;
            background: var(--light-bg);
            color: var(--light-text);
            transition: background-color 0.3s, color 0.3s;
        }

        body.dark-mode {
            background: var(--dark-bg);
            color: var(--dark-text);
        }

        #canvas {
            width: 100vw;
            height: 100vh;
        }

        #darkModeToggle {
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 10px 15px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.1s;
            font-family: 'Montserrat', sans-serif;
            font-weight: bold;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        #darkModeToggle:hover {
            background-color: var(--secondary);
            transform: translateY(-2px);
        }

        body.dark-mode #darkModeToggle {
            background-color: var(--secondary);
        }

        #infoWindow {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80%;
            max-width: 600px;
            height: 80%;
            max-height: 600px;
            background-color: var(--light-bg);
            border: 2px solid var(--light-accent);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            z-index: 1000;
            overflow-y: auto;
            font-family: 'Montserrat', sans-serif;
            transition: all 0.3s ease;
        }

        #infoWindow.dark-mode {
            background-color: var(--dark-bg);
            color: var(--dark-text);
            border-color: var(--dark-accent);
        }

        #closeButton {
            position: absolute;
            top: 15px;
            right: 15px;
            cursor: pointer;
            font-size: 24px;
            color: var(--light-accent);
            transition: color 0.3s;
        }

        #closeButton:hover {
            color: var(--primary);
        }

        #infoWindow h2 {
            text-align: center;
            color: var(--primary);
            font-size: 28px;
            margin-bottom: 20px;
        }

        #infoWindow h3 {
            color: var(--secondary);
            font-size: 22px;
            margin-top: 25px;
            margin-bottom: 15px;
        }

        #infoWindow p {
            line-height: 1.6;
            margin-bottom: 15px;
        }

        @media (max-width: 768px) {
            #infoWindow {
                width: 95%;
                height: 95%;
                padding: 20px;
            }
        }

        .hover-info {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 170px;
            background-color: var(--light-bg);
            border: 2px solid var(--light-accent);
            border-radius: 15px;
            padding: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            z-index: 900;
            font-family: 'Montserrat', sans-serif;
            transition: all 0.3s ease;
            color: var(--light-text);
        }

        .hover-info.dark-mode {
            background-color: var(--dark-bg);
            color: var(--dark-text);
            border-color: var(--dark-accent);
        }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>
    <button id="darkModeToggle">
        <i class="fas fa-moon"></i> Dark Mode
    </button>
    <div id="infoWindow">
        <i id="closeButton" class="fas fa-times"></i>
        <div id="infoContent"></div>
    </div>
    <div id="hoverInfo" class="hover-info"></div>
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const darkModeToggle = document.getElementById('darkModeToggle');
        const infoWindow = document.getElementById('infoWindow');
        const infoContent = document.getElementById('infoContent');
        const closeButton = document.getElementById('closeButton');
        const hoverInfo = document.getElementById('hoverInfo');
        let isDarkMode = false;

        const sephiroth = [
            ["Keter", "#FFFFFF", "Metatron"],
            ["Chokmah", "#808080", "Raziel"],
            ["Binah", "#000000", "Tzaphkiel"],
            ["Chesed", "#0000FF", "Tzadkiel"],
            ["Geburah", "#FF0000", "Khamael"],
            ["Tiferet", "#FFFF00", "Raphael"],
            ["Netzach", "#00FF00", "Haniel"],
            ["Hod", "#FFA500", "Michael"],
            ["Yesod", "#800080", "Gabriel"],
            ["Malkuth", "#8B4513", "Sandalphon"]
        ];

        const qliphoth = [
            ["Thaumiel", "#000000", "Satan & Moloch"],
            ["Ghagiel", "#8B0000", "Beelzebub"],
            ["Satariel", "#4B0082", "Lucifuge"],
            ["Gha'agsheblah", "#006400", "Astaroth"],
            ["Golachab", "#8B4513", "Asmodeus"],
            ["Tagiriron", "#708090", "Belphegor"],
            ["Harab Serapel", "#800080", "Baal"],
            ["Samael", "#B22222", "Adramelech"],
            ["Gamaliel", "#2F4F4F", "Lilith"],
            ["Nehemoth", "#A9A9A9", "Nahema"]
        ];

        const connections = [
            [0, 1], [0, 2], [1, 2], [1, 3], [1, 5], [2, 4], [2, 5],
            [3, 4], [3, 5], [3, 6], [4, 5], [4, 7], [5, 6], [5, 7],
            [5, 8], [6, 7], [6, 8], [7, 8], [8, 9], [6, 9], [7, 9],
            [0, 5]
        ];

        let lifeCenters = [];
        let deathCenters = [];
        let lastHighlightedIndex = -1;

        const treeInfo = {
            0: {
                title: "Keter / Thaumiel",
                content: `
                    <h3>Keter (Krona)</h3>
                    <p>Keter representerar den högsta punkten i Livets träd och symboliserar det gudomliga ursprunget till all skapelse. Det är den första emanationen av Ein Sof (det oändliga) och representerar ren existens bortom all form och begränsning.</p>
                    
                    <h3>Thaumiel (Tvillinggudar)</h3>
                    <p>Thaumiel är Keters skuggsida och representerar dualitet och splittring. Det symboliserar konflikten mellan motstridiga krafter och illusionen av separation från det gudomliga.</p>
                `
            },
            1: {
                title: "Chokmah / Ghagiel",
                content: `
                    <h3>Chokmah (Visdom)</h3>
                    <p>Chokmah representerar den kreativa impulsen och den gudomliga visdomen. Det är den aktiva, maskulina kraften i skapelsen och symboliserar insikt och inspiration.</p>
                    
                    <h3>Ghagiel (De som hindrar)</h3>
                    <p>Ghagiel är Chokmahs skuggsida och representerar förvirring och obalans. Det symboliserar missriktad energi och kaos som hindrar sann visdom och kreativitet.</p>
                `
            },
            2: {
                title: "Binah / Satariel",
                content: `
                    <h3>Binah (Förståelse)</h3>
                    <p>Binah representerar den passiva, feminina kraften i skapelsen. Det symboliserar förståelse, analys och den strukturerande principen i universum.</p>
                    
                    <h3>Satariel (Döljande av Gud)</h3>
                    <p>Satariel är Binahs skuggsida och representerar förvrängning och förnekelse av sanningen. Det symboliserar illusioner som döljer den gudomliga verkligheten.</p>
                `
            },
            3: {
                title: "Chesed / Gha'agsheblah",
                content: `
                    <h3>Chesed (Nåd)</h3>
                    <p>Chesed representerar kärlek, nåd och barmhärtighet. Det symboliserar expansiv energi och den uppbyggande kraften i universum.</p>
                    
                    <h3>Gha'agsheblah (De som stör)</h3>
                    <p>Gha'agsheblah är Cheseds skuggsida och representerar överdriven expansion och slöseri. Det symboliserar missbruk av makt och resurser.</p>
                `
            },
            4: {
                title: "Geburah / Golachab",
                content: `
                    <h3>Geburah (Styrka)</h3>
                    <p>Geburah representerar rättvisa, styrka och disciplin. Det symboliserar den nedbrytande och renande kraften i universum.</p>
                    
                    <h3>Golachab (De brinnande)</h3>
                    <p>Golachab är Geburahs skuggsida och representerar brutalitet och destruktiv kraft. Det symboliserar hämnd och obarmhärlig förstörelse.</p>
                `
            },
            5: {
                title: "Tiferet / Tagiriron",
                content: `
                    <h3>Tiferet (Skönhet)</h3>
                    <p>Tiferet representerar harmoni, balans och skönhet. Det är den centrala punkten i Livets träd och symboliserar integration av motsatser.</p>
                    
                    <h3>Tagiriron (De som strider)</h3>
                    <p>Tagiriron är Tiferets skuggsida och representerar obalans och splittring. Det symboliserar egoism och materialism som stör den gudomliga harmonin.</p>
                `
            },
            6: {
                title: "Netzach / Harab Serapel",
                content: `
                    <h3>Netzach (Seger)</h3>
                    <p>Netzach representerar känslor, passion och instinkt. Det symboliserar kreativitet, kärlek och den drivande kraften bakom naturens cykler.</p>
                    
                    <h3>Harab Serapel (Dödens raviner)</h3>
                    <p>Harab Serapel är Netzachs skuggsida och representerar överdriven känslomässighet och själviskhet. Det symboliserar besatthet och destruktiva begär.</p>
                `
            },
            7: {
                title: "Hod / Samael",
                content: `
                    <h3>Hod (Prakt)</h3>
                    <p>Hod representerar intellekt, kommunikation och logik. Det symboliserar struktur, ordning och den rationella aspekten av medvetandet.</p>
                    
                    <h3>Samael (Guds gift)</h3>
                    <p>Samael är Hods skuggsida och representerar lögner och falskhet. Det symboliserar manipulation och missbruk av kunskap och kommunikation.</p>
                `
            },
            8: {
                title: "Yesod / Gamaliel",
                content: `
                    <h3>Yesod (Grund)</h3>
                    <p>Yesod representerar det undermedvetna, drömmar och fantasi. Det symboliserar den astrala världen och fungerar som en bro mellan de högre sfärerna och den fysiska världen.</p>
                    
                    <h3>Gamaliel (De obscena)</h3>
                    <p>Gamaliel är Yesods skuggsida och representerar förvrängning av det undermedvetna. Det symboliserar illusion, förvirring och sexuell perversion.</p>
                `
            },
            9: {
                title: "Malkuth / Nehemoth",
                content: `
                    <h3>Malkuth (Kungadöme)</h3>
                    <p>Malkuth representerar den fysiska världen och vår vardagliga verklighet. Det symboliserar manifestation och är den sista emanationen i Livets träd.</p>
                    
                    <h3>Nehemoth (De klagande)</h3>
                    <p>Nehemoth är Malkuths skuggsida och representerar den mörka sidan av den materiella världen. Det symboliserar demonisk besatthet och förtvivlan över den fysiska existensen.</p>
                `
            }
        };

        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            drawTrees();
        }

        function drawTree(startX, startY, scaleX, scaleY, nodes, inverted = false) {
            const positions = [
                [50, inverted ? 95 : 5],
                [25, inverted ? 80 : 20],
                [75, inverted ? 80 : 20],
                [25, inverted ? 60 : 40],
                [75, inverted ? 60 : 40],
                [50, 50],
                [25, inverted ? 40 : 60],
                [75, inverted ? 40 : 60],
                [50, inverted ? 20 : 80],
                [50, inverted ? 5 : 95]
            ];

            ctx.strokeStyle = isDarkMode ? 'rgba(255, 255, 255, 0.6)' : 'rgba(0, 0, 0, 0.6)';
            ctx.lineWidth = 2;
            for (let [start, end] of connections) {
                let [x1, y1] = positions[start];
                let [x2, y2] = positions[end];
                ctx.beginPath();
                ctx.moveTo(startX + x1 * scaleX, startY + y1 * scaleY);
                ctx.lineTo(startX + x2 * scaleX, startY + y2 * scaleY);
                ctx.stroke();
            }

            const nodeCenters = [];
            for (let i = 0; i < nodes.length; i++) {
                const [name, color, _] = nodes[i];
                let [x, y] = positions[i];
                const radius = Math.min(canvas.width, canvas.height) / 30;
                const centerX = startX + x * scaleX;
                const centerY = startY + y * scaleY;

                ctx.beginPath();
                ctx.arc(centerX, centerY, radius + 3, 0, 2 * Math.PI);
                ctx.fillStyle = isDarkMode ? 'rgba(255, 255, 255, 0.2)' : 'rgba(0, 0, 0, 0.2)';
                ctx.fill();

                ctx.beginPath();
                ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);
                ctx.fillStyle = color;
                ctx.fill();

                ctx.font = `bold ${radius / 1.2}px Montserrat`;
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';

                ctx.strokeStyle = 'rgba(0, 0, 0, 0.8)';
                ctx.lineWidth = 4;
                ctx.strokeText(name, centerX, centerY);

                ctx.fillStyle = 'white';
                ctx.fillText(name, centerX, centerY);

                nodeCenters.push([centerX, centerY]);
            }

            return nodeCenters;
        }

        function drawTrees() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Gradient background
            const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
            if (isDarkMode) {
                gradient.addColorStop(0, '#1a202c');
                gradient.addColorStop(1, '#2d3748');
            } else {
                gradient.addColorStop(0, '#e2e8f0');
                gradient.addColorStop(1, '#f7fafc');
            }
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            const treeWidth = canvas.width / 2;
            const treeHeight = canvas.height;
            const titleHeight = 60;
            const scaleX = treeWidth / 100;
            const scaleY = (treeHeight - titleHeight) / 100;

            ctx.font = 'bold 32px Montserrat';
            ctx.fillStyle = isDarkMode ? 'var(--dark-text)' : 'var(--light-text)';
            ctx.textAlign = 'center';
            ctx.fillText("Livets Träd (Etz Chaim)", treeWidth / 2, titleHeight / 2);
            ctx.fillText("Dödens Träd (Sitra Achra)", treeWidth * 1.5, titleHeight / 2);

            lifeCenters = drawTree(0, titleHeight, scaleX, scaleY, sephiroth);
            deathCenters = drawTree(treeWidth, titleHeight, scaleX, scaleY, qliphoth, true);
        }

        function clearHighlight() {
            drawTrees();
            lastHighlightedIndex = -1;
        }

        function onHover(event) {
            // Kontrollera om informationsfönstret är öppet
            if (infoWindow.style.display === 'block') {
                hoverInfo.style.display = 'none';
                return;
            }
            const rect = canvas.getBoundingClientRect();
            const x = event.clientX - rect.left;
            const y = event.clientY - rect.top;

            clearHighlight();

            const radius = Math.min(canvas.width, canvas.height) / 30;
            for (let i = 0; i < lifeCenters.length; i++) {
                const [x1, y1] = lifeCenters[i];
                const [x2, y2] = deathCenters[i];

                if ((Math.abs(x - x1) <= radius && Math.abs(y - y1) <= radius) ||
                    (Math.abs(x - x2) <= radius && Math.abs(y - y2) <= radius)) {
                    
                    ctx.beginPath();
                    ctx.moveTo(x1, y1);
                    ctx.lineTo(x2, y2);
                    ctx.strokeStyle = 'var(--secondary)';
                    ctx.lineWidth = 3;
                    ctx.stroke();

                    const angel = sephiroth[i][2];
                    const demon = qliphoth[i][2];
                    const text = `Ängel: ${angel}\nDemon: ${demon}`;

                    const textX = canvas.width / 2;
                    const textY = canvas.height / 2;

                    hoverInfo.innerHTML = `<p>${text.replace('\n', '<br>')}</p>`;
                    hoverInfo.style.display = 'block';
                    hoverInfo.classList.toggle('dark-mode', isDarkMode);

                    hoverInfo.style.left = `${textX}px`;
                    hoverInfo.style.top = `${textY}px`;

                    lastHighlightedIndex = i;
                    break;
                } else {
                    hoverInfo.style.display = 'none';
                }
            }
        }

        function onClick(event) {
            const rect = canvas.getBoundingClientRect();
            const x = event.clientX - rect.left;
            const y = event.clientY - rect.top;

            const radius = Math.min(canvas.width, canvas.height) / 30;
            for (let i = 0; i < lifeCenters.length; i++) {
                const [x1, y1] = lifeCenters[i];
                const [x2, y2] = deathCenters[i];

                if ((Math.abs(x - x1) <= radius && Math.abs(y - y1) <= radius) ||
                    (Math.abs(x - x2) <= radius && Math.abs(y - y2) <= radius)) {
                    showInfoWindow(i);
                    break;
                }
            }
        }

        function showInfoWindow(index) {
            const info = treeInfo[index];
            if (info) {
                infoContent.innerHTML = `<h2>${info.title}</h2>${info.content}`;
                infoWindow.style.display = 'block';
                infoWindow.classList.toggle('dark-mode', isDarkMode);
            }
        }

        function toggleDarkMode() {
            isDarkMode = !isDarkMode;
            document.body.classList.toggle('dark-mode');
            infoWindow.classList.toggle('dark-mode', isDarkMode);
            hoverInfo.classList.toggle('dark-mode', isDarkMode);
            darkModeToggle.innerHTML = isDarkMode ? '<i class="fas fa-sun"></i> Light Mode' : '<i class="fas fa-moon"></i> Dark Mode';
            drawTrees();
        }

        window.addEventListener('resize', resizeCanvas);
        canvas.addEventListener('mousemove', onHover);
        canvas.addEventListener('click', onClick);
        darkModeToggle.addEventListener('click', toggleDarkMode);
        closeButton.addEventListener('click', () => {
            infoWindow.style.display = 'none';
        });

        resizeCanvas();
    </script>
</body>
</html>
